<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Label placement for points to avoid overlaps — pointLabel • maptools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Label placement for points to avoid overlaps — pointLabel" />
<meta property="og:description" content="Use optimization routines to find good locations for point labels
  without overlaps." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">maptools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Label placement for points to avoid overlaps</h1>
    
    <div class="hidden name"><code>pointLabelBase.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Use optimization routines to find good locations for point labels
  without overlaps.</p>
    </div>

    <pre class="usage"><span class='fu'>pointLabel</span>(<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>along</span> <span class='kw'>=</span> <span class='no'>x</span>), <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1</span>,
           <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"SANN"</span>, <span class='st'>"GA"</span>),
           <span class='kw'>allowSmallOverlap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
           <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
           <span class='kw'>doPlot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x, y</th>
      <td><p>as with <code>plot.default</code>, these provide the x and y coordinates for
          the point labels.  Any reasonable way of defining the coordinates is
          acceptable.  See the function <code>xy.coords</code> for details.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>as with <code>text</code>, a character vector or expression specifying the text to be
          written.  An attempt is made to coerce other language objects
          (names and calls) to expressions, and vectors and other
          classed objects to character vectors by <code>as.character</code>.</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>numeric character expansion factor as with <code>text</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>the optimization method, either &#8220;SANN&#8221; for simulated
          annealing (the default) or &#8220;GA&#8221; for a genetic algorithm.</p></td>
    </tr>
    <tr>
      <th>allowSmallOverlap</th>
      <td><p>logical; if <code>TRUE</code>, labels are allowed
          a small overlap. The overlap allowed is 2% of the diagonal
          distance of the plot area.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>logical; if <code>TRUE</code>, status updates are given as the optimization algorithms
          progress.</p></td>
    </tr>
    <tr>
      <th>doPlot</th>
      <td><p>logical; if <code>TRUE</code>, the labels are plotted on the
          existing graph with <code>text</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed along to <code>text</code> to specify
          labeling parameters such as <code>col</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
  
<p>Eight positions are candidates for label placement, either
  horizontally, vertically, or diagonally offset from the points. The
  default position for labels is the top right diagonal relative to the
  point (considered the preferred label position).</p>
<p>With the default settings, simulating annealing solves faster than the
  genetic algorithm. It is an open question as to which settles into a
  global optimum the best (both algorithms have parameters that may be
  tweaked).</p>
<p>The label positioning problem is NP-hard (nondeterministic
  polynomial-time hard). Placement becomes difficult and slows
  considerably with large numbers of points. This function places all
  labels, whether overlaps occur or not. Some placement algorithms
  remove labels that overlap.</p>  
<p>Note that only <code>cex</code> is used to calculate string width and
  height (using <code>strwidth</code> and <code>strheight</code>), so passing a
  different font may corrupt the label dimensions. You could get around
  this by adjusting the font parameters with <code>par</code> prior to running
  this function.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code>xy</code> list giving the <code>x</code> and <code>y</code> positions of the
  label as would be placed by <code><a href='https://rdrr.io/r/graphics/text.html'>text(xy, labels)</a></code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p><a href='https://en.wikipedia.org/wiki/Automatic_label_placement'>https://en.wikipedia.org/wiki/Automatic_label_placement</a></p>
<p><a href='http://i11www.iti.uni-karlsruhe.de/map-labeling/bibliography/'>http://i11www.iti.uni-karlsruhe.de/map-labeling/bibliography/</a></p>
<p><a href='http://www.eecs.harvard.edu/~shieber/Projects/Carto/carto.html'>http://www.eecs.harvard.edu/~shieber/Projects/Carto/carto.html</a></p>
<p><a href='http://www.szoraster.com/Cartography/PracticalExperience.htm'>http://www.szoraster.com/Cartography/PracticalExperience.htm</a></p>
<p>The genetic algorithm code was adapted from the python code at</p>
<p><a href='https://meta.wikimedia.org/wiki/Map_generator'>https://meta.wikimedia.org/wiki/Map_generator</a>.</p>
<p>The simulated annealing code follows the algorithm and guidelines in:</p>
<p>Jon Christensen, Joe Marks, and Stuart Shieber. Placing text labels on
maps and diagrams. In Paul Heckbert, editor, Graphics Gems IV, pages
497-504. Academic Press, Boston, MA, 1994.
<a href='http://www.eecs.harvard.edu/~shieber/Biblio/Papers/jc.label.pdf'>http://www.eecs.harvard.edu/~shieber/Biblio/Papers/jc.label.pdf</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/graphics/text.html'>text</a></code>, <code><a href='https://rdrr.io/pkg/plotrix/man/thigmophobe.labels.html'>thigmophobe.labels</a></code>
  in package <span class="pkg">plotrix</span></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)*<span class='fl'>10</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)*<span class='fl'>10</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>20</span>)</div><div class='input'><span class='fu'>pointLabel</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>x</span>,<span class='fl'>5</span>)), <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.7</span>)</div><div class='img'><img src='pointLabelBase-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>20</span>)</div><div class='input'><span class='fu'>pointLabel</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>over</a></span>(<span class='no'>alpha</span>, <span class='no'>beta</span>[<span class='fl'>123</span>])), <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.8</span>)</div><div class='img'><img src='pointLabelBase-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Nicholas Lewin-Koh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


