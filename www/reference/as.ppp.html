<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Coercion between sp objects and spatstat ppp objects — as.ppp • maptools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Coercion between sp objects and spatstat ppp objects — as.ppp" />
<meta property="og:description" content="Functions to convert between spatstats planar point pattern (ppp)
format and sps SpatialPoints and SpatialPointsDataFrame as
well as one-way conversion from SpatialGridDataFrame to ppp.
S4-style as() coercion can be used as well." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">maptools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Coercion between sp objects and spatstat ppp objects</h1>
    
    <div class="hidden name"><code>as.ppp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to convert between <span class="pkg">spatstat</span>s planar point pattern (<code>ppp</code>)
format and <span class="pkg">sp</span>s <code>SpatialPoints</code> and <code>SpatialPointsDataFrame</code> as
well as one-way conversion from <code>SpatialGridDataFrame</code> to <code>ppp</code>.
S4-style <code>as()</code> coercion can be used as well.</p>
    </div>

    <pre class="usage"><span class='fu'>as.ppp.SpatialPoints</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='fu'>as.ppp.SpatialPointsDataFrame</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='fu'>as.SpatialPoints.ppp</span><span class='op'>(</span><span class='va'>from</span><span class='op'>)</span>
<span class='fu'>as.SpatialPointsDataFrame.ppp</span><span class='op'>(</span><span class='va'>from</span><span class='op'>)</span>
<span class='fu'>as.SpatialGridDataFrame.ppp</span><span class='op'>(</span><span class='va'>from</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>from, X</th>
      <td><p>object to coerce from</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <p></p><dl>
<dt>coerce</dt><dd><p><code>signature(from = "SpatialPoints", to = "ppp")</code></p></dd>
<dt>coerce</dt><dd><p><code>signature(from = "SpatialPointsDataFrame", to = "ppp")</code></p></dd>
<dt>coerce</dt><dd><p><code>signature(from = "ppp", to = "SpatialGridDataFrame")</code></p></dd>
<dt>coerce</dt><dd><p><code>signature(from = "ppp", to = "SpatialPointsDataFrame")</code></p></dd>
<dt>coerce</dt><dd><p><code>signature(from = "ppp", to = "SpatialPoints")</code></p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The main conversion is between <span class="pkg">sp</span>s
<code>SpatialPoints</code>/<code>SpatialPointsDataFrame</code> and <span class="pkg">spatstat</span>s
<code>ppp</code>. Conversion between <code>SpatialGridDataFrame</code> and <code>ppp</code> should
rarely be used; using <code><a href='as.owin.html'>as.owin.SpatialGridDataFrame</a></code> is more transparent.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>ppp</code> format requires an observation window which is the sampling
region. The <span class="pkg">sp</span> formats contain no such information and by default the
bounding box of the points is simply used. This is almost never the correct
thing to do! Rather, information about the sampling region should be converted
into <span class="pkg">spatstat</span>s <code><a href='https://rdrr.io/pkg/spatstat.geom/man/owin.html'>owin</a></code> format and assigned as the
observation window. Usually conversion from <code>ppp</code> to <span class="pkg">sp</span> format simply
discards the <code>owin</code>. However, <code>as.SpatialGridDataFrame.ppp</code> actually
first discards the points(!), second checks that the corresponding <code>owin</code>
is in a grid format (matrix of TRUE/FALSE for inside/outside sampling region),
and finally converts the TRUE/FALSE grid to a <code>SpatialGridDataFrame</code>.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>In <span class="pkg">spatstat</span> all spatial objects are assumed to be planar. This means
  that <span class="pkg">spatstat</span> is not designed to work directly with geographic
  (longitude and latitude) coordinates. If a <span class="pkg">sp</span> object is declared to
  have geographic (unprojected) coordinates <span class="pkg">maptools</span> refuses to convert
  directly to <span class="pkg">spatstat</span> format. Rather, these should be projected first
  using e.g. <code><a href='https://rdrr.io/pkg/sp/man/spTransform.html'>spTransform</a></code>. If you know what you are doing, and
  really want to force coercion, you can overwrite the <code>proj4string</code> of the
  <span class="pkg">sp</span> object with <code>NA</code>, <code>proj4string(x) &lt;- CRS(NA)</code>, which
  will fool the system to think that the data is in local planar coordinates.
  This is probably not a good idea!</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edzer Pebesma <a href='mailto:edzer.pebesma@uni-muenster.de'>edzer.pebesma@uni-muenster.de</a>, Roger Bivand</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='http://spatstat.org/'>"spatstat.geom"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Convert SpatialPointsDataFrame into a marked ppp</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/xyFromCell.html'>coordinates</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span> <span class='op'>=</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>
<span class='va'>meuse_ppp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>meuse</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>meuse_ppp</span> <span class='co'># Window is the bounding rectangle</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: some mark values are NA in the point pattern x</span></div><div class='output co'>#&gt; Marked planar point pattern: 155 points
#&gt; Mark variables: 
#&gt;    cadmium copper lead zinc elev dist om ffreq soil lime landuse dist.m
#&gt; window: rectangle = [178605, 181390] x [329714, 333611] units</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>meuse_ppp</span>, which.marks <span class='op'>=</span> <span class='st'>"zinc"</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='as.ppp-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Convert SpatialPoints into an unmarked ppp</span>
<span class='va'>meuse2</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>meuse</span>, <span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='fu'>as</span><span class='op'>(</span><span class='va'>meuse2</span>, <span class='st'>"ppp"</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; Planar point pattern: 155 points
#&gt; window: rectangle = [178605, 181390] x [329714, 333611] units</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Get sampling region in grid format and assign it as observation window</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span>
<span class='fu'>gridded</span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>
<span class='va'>mg_owin</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>meuse.grid</span>, <span class='st'>"owin"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/spatstat.geom/man/Window.html'>Window</a></span><span class='op'>(</span><span class='va'>meuse_ppp</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>mg_owin</span>
<span class='va'>meuse_ppp</span> <span class='co'># Window is now a binary image mask (TRUE/FALSE grid)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: as.matrix.SpatialGridDataFrame uses first column;</span>
#&gt; <span class='warning'> use subset or [] for other columns</span></div><div class='output co'>#&gt; <span class='warning'>Warning: some mark values are NA in the point pattern x</span></div><div class='output co'>#&gt; Marked planar point pattern: 155 points
#&gt; Mark variables: 
#&gt;    cadmium copper lead zinc elev dist om ffreq soil lime landuse dist.m
#&gt; window: binary image mask
#&gt; 104 x 78 pixel array (ny, nx)
#&gt; enclosing rectangle: [178440, 181560] x [329600, 333760] units</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>meuse_ppp</span>, which.marks <span class='op'>=</span> <span class='st'>"zinc"</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='as.ppp-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Convert marked ppp back to SpatialPointsDataFrame</span>
<span class='va'>rev_ppp_SPDF</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialPointsDataFrame.ppp</span><span class='op'>(</span><span class='va'>meuse_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rev_ppp_SPDF</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; Object of class SpatialPointsDataFrame
#&gt; Coordinates:
#&gt;       min    max
#&gt; mx 178605 181390
#&gt; my 329714 333611
#&gt; Is projected: NA 
#&gt; proj4string : [NA]
#&gt; Number of points: 155
#&gt; Data attributes:
#&gt;  marks.cadmium     marks.copper      marks.lead      marks.zinc    
#&gt;  Min.   : 0.200   Min.   : 14.00   Min.   : 37.0   Min.   : 113.0  
#&gt;  1st Qu.: 0.800   1st Qu.: 23.00   1st Qu.: 72.5   1st Qu.: 198.0  
#&gt;  Median : 2.100   Median : 31.00   Median :123.0   Median : 326.0  
#&gt;  Mean   : 3.246   Mean   : 40.32   Mean   :153.4   Mean   : 469.7  
#&gt;  3rd Qu.: 3.850   3rd Qu.: 49.50   3rd Qu.:207.0   3rd Qu.: 674.5  
#&gt;  Max.   :18.100   Max.   :128.00   Max.   :654.0   Max.   :1839.0  
#&gt;                                                                    
#&gt;    marks.elev       marks.dist         marks.om      marks.ffreq marks.soil
#&gt;  Min.   : 5.180   Min.   :0.00000   Min.   : 1.000   1:84        1:97      
#&gt;  1st Qu.: 7.546   1st Qu.:0.07569   1st Qu.: 5.300   2:48        2:46      
#&gt;  Median : 8.180   Median :0.21184   Median : 6.900   3:23        3:12      
#&gt;  Mean   : 8.165   Mean   :0.24002   Mean   : 7.478                         
#&gt;  3rd Qu.: 8.955   3rd Qu.:0.36407   3rd Qu.: 9.000                         
#&gt;  Max.   :10.520   Max.   :0.88039   Max.   :17.000                         
#&gt;                                     NA's   :2                              
#&gt;  marks.lime marks.landuse  marks.dist.m   
#&gt;  0:111      W      :50    Min.   :  10.0  
#&gt;  1: 44      Ah     :39    1st Qu.:  80.0  
#&gt;             Am     :22    Median : 270.0  
#&gt;             Fw     :10    Mean   : 290.3  
#&gt;             Ab     : 8    3rd Qu.: 450.0  
#&gt;             (Other):25    Max.   :1000.0  
#&gt;             NA's   : 1                    </div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Convert marked ppp back to SpatialPoints (discarding marks)</span>
<span class='va'>rev_ppp_SP</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialPoints.ppp</span><span class='op'>(</span><span class='va'>meuse_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rev_ppp_SP</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; Object of class SpatialPoints
#&gt; Coordinates:
#&gt;       min    max
#&gt; mx 178605 181390
#&gt; my 329714 333611
#&gt; Is projected: NA 
#&gt; proj4string : [NA]
#&gt; Number of points: 155</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Convert marked ppp back to SpatialGridDataFrame (extracting the window grid)</span>
<span class='va'>rev_ppp_SGDF</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.ppp</span><span class='op'>(</span><span class='va'>meuse_ppp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rev_ppp_SGDF</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; Object of class SpatialGridDataFrame
#&gt; Coordinates:
#&gt;         min    max
#&gt; [1,] 178440 181560
#&gt; [2,] 329600 333760
#&gt; Is projected: NA 
#&gt; proj4string : [NA]
#&gt; Grid attributes:
#&gt;   cellcentre.offset cellsize cells.dim
#&gt; 1            178460       40        78
#&gt; 2            329620       40       104
#&gt; Data attributes:
#&gt;    mask        
#&gt;  Mode:logical  
#&gt;  TRUE:3103     
#&gt;  NA's:5009     </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Nicholas Lewin-Koh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


