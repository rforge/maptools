<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create SpatialGrid for PNG output to GE — GE_SpatialGrid • maptools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create SpatialGrid for PNG output to GE — GE_SpatialGrid" />
<meta property="og:description" content="The function sets up metadata in the form of a SpatialGrid object for defining the size and placing of a PNG image overlay in Google Earth. The internal function Sobj\_SpatialGrid can also be called to build a grid for arbitrary Spatial* objects." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">maptools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create SpatialGrid for PNG output to GE</h1>
    
    <div class="hidden name"><code>GE_SpatialGrid.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function sets up metadata in the form of a SpatialGrid object for defining the size and placing of a PNG image overlay in Google Earth. The internal function <code>Sobj\_SpatialGrid</code> can also be called to build a grid for arbitrary Spatial* objects.</p>
    </div>

    <pre class="usage"><span class='fu'>GE_SpatialGrid</span><span class='op'>(</span><span class='va'>obj</span>, asp <span class='op'>=</span> <span class='cn'>NA</span>, maxPixels <span class='op'>=</span> <span class='fl'>600</span><span class='op'>)</span>
<span class='fu'>Sobj_SpatialGrid</span><span class='op'>(</span><span class='va'>obj</span>, asp<span class='op'>=</span><span class='fl'>1</span>, maxDim<span class='op'>=</span><span class='fl'>100</span>, n<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>a Spatial* object</p></td>
    </tr>
    <tr>
      <th>asp</th>
      <td><p>if NA, will be set to the latitude corrected value</p></td>
    </tr>
    <tr>
      <th>maxPixels</th>
      <td><p>the maximum dimension of the output PNG</p></td>
    </tr>
    <tr>
      <th>maxDim</th>
      <td><p>the maximum dimension of the output grid; ignored if <code>n</code> not NULL</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>if not NULL, the minimum number of cells in the returned grid</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function is used together with <code>kmlOverlay</code> to wrap around the opening of a PNG graphics device, plotting code, and the closing of the device. The computed values take account of the adjustment of the actual data bounding box to an integer number of rows and columns in the image file.</p>
<p>The approach may be used as an alternative to writing PNG files from SpatialGrid and SpatialPixel objects in <span class="pkg">rgdal</span> using <code>writeGDAL</code>, and to writing KML files using <code>writeOGR</code> for vector data objects. The output PNG files are likely to be very much smaller than large vector data KML files, and hinder the retrieval of exact positional information.</p>
<p>Note that the geometries should be in geographical coordinates with datum WGS84 for export to KML.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns an S3 object of class <code>GE_SG</code> with components:</p>
<dt>height</dt><dd><p>Integer raster height for png call</p></dd>
  <dt>width</dt><dd><p>Integer raster width for png call</p></dd>
  <dt>SG</dt><dd><p>a SpatialGrid object with the grid topology of the output PNG</p></dd>
  <dt>asp</dt><dd><p>the aspect value used</p></dd>
  <dt>xlim</dt><dd><p>xlim taken from SG</p></dd>
  <dt>ylim</dt><dd><p>ylim taken from SG</p></dd>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Duncan Golicher, David Forrest and Roger Bivand</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='kmlOverlay.html'>kmlOverlay</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>opt_exask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>example.ask<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>qk</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialPointsDataFrame</span><span class='op'>(</span><span class='va'>quakes</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>quakes</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>Sobj_SpatialGrid</span><span class='op'>(</span><span class='va'>qk</span><span class='op'>)</span><span class='op'>$</span><span class='va'>SG</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Object of class SpatialGrid
#&gt; Coordinates:
#&gt;      min      max
#&gt; x 165.67 188.2447
#&gt; y -38.59 -10.7200
#&gt; Is projected: NA 
#&gt; proj4string : [NA]
#&gt; Grid attributes:
#&gt;   cellcentre.offset cellsize cells.dim
#&gt; x         165.80935   0.2787        81
#&gt; y         -38.45065   0.2787       100</div><div class='input'><span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='fu'>Sobj_SpatialGrid</span><span class='op'>(</span><span class='va'>qk</span>, n<span class='op'>=</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>$</span><span class='va'>SG</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>t2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Object of class SpatialGrid
#&gt; Coordinates:
#&gt;      min      max
#&gt; x 165.67 188.3144
#&gt; y -38.59 -10.7200
#&gt; Is projected: NA 
#&gt; proj4string : [NA]
#&gt; Grid attributes:
#&gt;   cellcentre.offset  cellsize cells.dim
#&gt; x         165.79442 0.2488393        91
#&gt; y         -38.46558 0.2488393       112</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='fu'>slot</span><span class='op'>(</span><span class='fu'>slot</span><span class='op'>(</span><span class='va'>t2</span>, <span class='st'>"grid"</span><span class='op'>)</span>, <span class='st'>"cells.dim"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 10192</div><div class='input'><span class='fu'>proj4string</span><span class='op'>(</span><span class='va'>qk</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+proj=longlat +ellps=WGS84"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum Unknown based on WGS84 ellipsoid in Proj4 definition</span></div><div class='input'><span class='va'>tf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>SGqk</span> <span class='op'>&lt;-</span> <span class='fu'>GE_SpatialGrid</span><span class='op'>(</span><span class='va'>qk</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>tf</span>, <span class='st'>".png"</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>, width<span class='op'>=</span><span class='va'>SGqk</span><span class='op'>$</span><span class='va'>width</span>, height<span class='op'>=</span><span class='va'>SGqk</span><span class='op'>$</span><span class='va'>height</span>,
  bg<span class='op'>=</span><span class='st'>"transparent"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>, xaxs<span class='op'>=</span><span class='st'>"i"</span>, yaxs<span class='op'>=</span><span class='st'>"i"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>qk</span>, xlim<span class='op'>=</span><span class='va'>SGqk</span><span class='op'>$</span><span class='va'>xlim</span>, ylim<span class='op'>=</span><span class='va'>SGqk</span><span class='op'>$</span><span class='va'>ylim</span>, setParUsrBB<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; agg_png 
#&gt;       2 </div><div class='input'><span class='fu'><a href='kmlOverlay.html'>kmlOverlay</a></span><span class='op'>(</span><span class='va'>SGqk</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>tf</span>, <span class='st'>".kml"</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>tf</span>, <span class='st'>".png"</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output</span></div><div class='output co'>#&gt; [1] "&lt;?xml version='1.0' encoding='UTF-8'?&gt;"                                                                           
#&gt; [2] "&lt;kml xmlns='http://earth.google.com/kml/2.0'&gt;"                                                                    
#&gt; [3] "&lt;GroundOverlay&gt;"                                                                                                  
#&gt; [4] "&lt;name&gt;R image&lt;/name&gt;"                                                                                             
#&gt; [5] "&lt;Icon&gt;&lt;href&gt;/tmp/RtmpNYUSJN/file71fe4c1de9b9.png&lt;/href&gt;&lt;viewBoundScale&gt;0.75&lt;/viewBoundScale&gt;&lt;/Icon&gt;"              
#&gt; [6] "&lt;LatLonBox&gt;&lt;north&gt;-10.72&lt;/north&gt;&lt;south&gt;-38.59&lt;/south&gt;&lt;east&gt;188.158103454744&lt;/east&gt;&lt;west&gt;165.67&lt;/west&gt;&lt;/LatLonBox&gt;"
#&gt; [7] "&lt;/GroundOverlay&gt;&lt;/kml&gt;"                                                                                           </div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>qk0</span> <span class='op'>&lt;-</span> <span class='va'>quakes</span>
<span class='va'>qk0</span><span class='op'>$</span><span class='va'>long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>qk0</span><span class='op'>$</span><span class='va'>long</span> <span class='op'>&lt;=</span> <span class='fl'>180</span>, <span class='va'>qk0</span><span class='op'>$</span><span class='va'>long</span>, <span class='va'>qk0</span><span class='op'>$</span><span class='va'>long</span><span class='op'>-</span><span class='fl'>360</span><span class='op'>)</span>
<span class='va'>qk0a</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialPointsDataFrame</span><span class='op'>(</span><span class='va'>qk0</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>qk0</span><span class='op'>)</span>
<span class='fu'>proj4string</span><span class='op'>(</span><span class='va'>qk0a</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+proj=longlat +ellps=WGS84"</span><span class='op'>)</span>
<span class='co'># writeOGR(qk0a, paste(tf, "v.kml", sep=""), "Quakes", "KML")</span>
<span class='co'># system(paste("googleearth ", tf, ".kml", sep=""))</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>example.ask<span class='op'>=</span><span class='va'>opt_exask</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Nicholas Lewin-Koh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


